events {}

http {
    include mime.types;
    default_type application/octet-stream;

    sendfile on;
    keepalive_timeout 65;

    server {
        listen 80 default_server;
        listen [::]:80 default_server;

        server_name _;

        root /usr/share/nginx/html;

        # ✅ Bloqueia cache do index.html (SPA como React, Vue, etc.)
        location = /index.html {
            try_files $uri $uri/ =404;

            add_header Cache-Control "no-store, no-cache, must-revalidate, proxy-revalidate, max-age=0" always;
            add_header Pragma "no-cache" always;
            add_header Expires 0 always;
        }

        # ✅ Outros arquivos (js, css, etc.) seguem o cache padrão (opcional)
        location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg|woff|woff2|ttf|eot|otf)$ {
            expires 30d;
            add_header Cache-Control "public";
            try_files $uri =404;
        }

        # ✅ Rota principal para SPA
        location / {
            try_files $uri $uri/ /index.html;
        }
    }
}
